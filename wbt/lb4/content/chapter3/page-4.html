---
title: "Annahme 3: Homoskedastizität"  # Titel der Seite
weight: 304  # Individuelles Gewicht 
menuTitle: "Homoskedastizität" # Falls Titel zulang ist, hier Kurztitel
tags: ["regressionsdiagnostik", "homoskedastizitaet"]  # Tags hiereinsetzen; Kurzwort, was auf der Seite passsiert
---

<script src="/statsplus/lb4/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>Die dritte Annahme ist <strong>Homoskedastizität</strong>. <strong>Homoskedastizität</strong> bedeutete, dass die Varianz der Resdiuen annähernd gleich ist und nicht variiert.</p>
<p>Um zu diagnostizieren, ob die Varianzen der Residuen gleiche Varianzen aufweisen, ändern wir das zweite Argument in der Funktion <code>plot()</code> auf den Wert <code>3</code>:</p>
<pre class="r"><code>plot(
  olsModel2, 
  3
)</code></pre>
<p><img src="/statsplus/lb4/chapter3/page-4_files/figure-html/assumption3-1.png" width="672" /></p>
<p><span class="math inline">\(\Rightarrow\)</span> die Punkte sollten gleichmäßig um die horzontale Linie gelegen sein. Mit pseudo-metrischen Daten ist das ganze nur schwer zu interpretieren.</p>
<p>Mit der <strong>library</strong> <code>ggplot</code> ist die Darstellung besser, da wir die Datenpunkt jittern lassen können. Wie du <code>ggplot</code> genau anwendest, lernst du im Lernblock 5!</p>
<pre class="r"><code>ggplot(
  olsModel2, 
  aes(.fitted, 
      sqrt(abs(.stdresid))
  )
) + 
  geom_point(na.rm = TRUE) +
  geom_jitter(
    width = 0.35,
    height = 0.35
  ) +
  stat_smooth(
    method = &quot;loess&quot;,
    na.rm = TRUE,
    se = FALSE
  ) + 
  xlab(&quot;Fitted Values&quot;) + 
  ylab(expression(sqrt(&quot;Standardized residuals&quot;))) + 
  ggtitle(&quot;Scale-Location&quot;)</code></pre>
<p><img src="/statsplus/lb4/chapter3/page-4_files/figure-html/assumption3b-1.png" width="672" /></p>
<p><span class="math inline">\(\Rightarrow\)</span> Punkte sollten gleichmäßig um die horizontale Linie streuen.</p>
<p>Wir können auch einen statistischen Test durchführen. Dies ist hilfreich, wenn die grafische Analyse schwerfällt. Dieser Test heißt <strong>Breusch-Pagan-Test</strong>.</p>
<ul>
<li><span class="math inline">\(H_0:\)</span> Es liegen homoskedastische Residuen vor.</li>
</ul>
<p>Dazu nutzen wir die Funktion <code>bptest()</code> aus der <strong>library</strong> <code>lmtest</code>:</p>
<pre class="r"><code>library(&quot;lmtest&quot;)

bptest(olsModel2)</code></pre>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  olsModel2
## BP = 1.8224, df = 2, p-value = 0.402</code></pre>
<p>Der p-Wert zeigt uns an, dass die Nullhypothese nicht abgelehnt werden kann. Wir können daher homskedastische Residuen annehmen und die Annahme als erfüllt ansehen!</p>
<div id="hilfe-bei-heteroskedastischen-daten" class="section level2">
<h2>Hilfe bei heteroskedastischen Daten</h2>
<p>Wenn heteroskedastische Daten vorliegen, können wir eine sogenannte <em>robuste</em> Schätzungen durchführen. Dies inkludiert mathematische Verfahren, die nicht in dem Maße durch heteroskedastische Daten beeinflusst werden. Die Interpretation der Kennwerte bleibt genau gleich. Dazu verwendest du die <strong>library</strong> <code>robustbase</code>:</p>
<pre class="r"><code>install.packages(&quot;robustbase&quot;)
library(&quot;robustbase&quot;)

# Just use function lmrob() as lm()
olsModel2rob &lt;- lmrob(
  stfdem ~ 1 + stfeco + trstlgl,
  data = pss
)

summary(olsModel2rob)</code></pre>
<p>Das Ergebnis wird ergänzt um sogenannte <em>robustness weights</em>, die aber erstmal für dich nicht interessant sind. Der obere Teil wird wie zuvor interpretiert!</p>
</div>
